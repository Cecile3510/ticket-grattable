<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Carte à gratter cœur</title>
<style>
  html, body {
    margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden;
  }
  body {
    background: url('images/fille%20ou%20garcon%20v2.png') no-repeat center center;
    background-size: cover;
  }
  #container {
    position: relative;
    width: 1080px;
    height: 1920px;
    margin: auto;
  }
  canvas {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    cursor: pointer;
  }
</style>
</head>
<body>
  <div id="container">
    <canvas id="scratchCanvas" width="300" height="300"></canvas>
  </div>

<script>
const canvas = document.getElementById('scratchCanvas');
const ctx = canvas.getContext('2d');

// Dessiner la forme du cœur (au centre du canvas)
function drawHeartPath(ctx, x, y, size) {
  ctx.beginPath();
  const topCurveHeight = size * 0.3;
  ctx.moveTo(x, y + topCurveHeight);
  ctx.bezierCurveTo(
    x, y,
    x - size / 2, y,
    x - size / 2, y + topCurveHeight
  );
  ctx.bezierCurveTo(
    x - size / 2, y + size / 1.5,
    x, y + size,
    x, y + size
  );
  ctx.bezierCurveTo(
    x, y + size,
    x + size / 2, y + size / 1.5,
    x + size / 2, y + topCurveHeight
  );
  ctx.bezierCurveTo(
    x + size / 2, y,
    x, y,
    x, y + topCurveHeight
  );
  ctx.closePath();
}

// Remplir la zone grattable
function drawScratchArea() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.save();
  drawHeartPath(ctx, canvas.width / 2, 30, 240);
  ctx.clip();
  ctx.fillStyle = '#aaa'; // Couleur de la surface à gratter
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.restore();
}

// Initialisation
drawScratchArea();

let isDrawing = false;

canvas.addEventListener('mousedown', () => isDrawing = true);
canvas.addEventListener('mouseup', () => isDrawing = false);
canvas.addEventListener('mouseleave', () => isDrawing = false);

canvas.addEventListener('mousemove', (e) => {
  if (!isDrawing) return;

  const rect = canvas.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;

  ctx.save();
  drawHeartPath(ctx, canvas.width / 2, 30, 240);
  ctx.clip();

  ctx.globalCompositeOperation = 'destination-out';
  ctx.beginPath();
  ctx.arc(x, y, 15, 0, 2 * Math.PI);
  ctx.fill();

  ctx.restore();
});
</script>
</body>
</html>

