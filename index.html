<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Carte à gratter style Persée</title>
<style>
  html, body {
    margin: 0; padding: 0; height: 100vh; width: 100vw;
    background: #222;
    display: flex; justify-content: center; align-items: center;
  }
  #card {
    position: relative;
    width: 600px;
    height: 1200px;
    background: white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    border-radius: 15px;
    overflow: hidden;
  }
  #backgroundImage {
    width: 100%;
    height: 100%;
    object-fit: contain;
    display: block;
  }
  #scratchCanvas {
    position: absolute;
    top: 580px;  /* position verticale de la zone grattable */
    left: 50%;
    transform: translateX(-50%);
    width: 460px;
    height: 250px;
    border-radius: 20px;
    cursor: pointer;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
  }
</style>
</head>
<body>
  <div id="card">
    <img id="backgroundImage" src="images/fille-ou-garcon-v2.png" alt="Carte annonce sexe bébé" />
    <canvas id="scratchCanvas" width="460" height="250"></canvas>
  </div>

<script>
  const canvas = document.getElementById('scratchCanvas');
  const ctx = canvas.getContext('2d');

  // Dessine la zone grattable argentée (rectangle arrondi)
  function drawScratchArea() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#bbb';
    const radius = 20;
    const w = canvas.width;
    const h = canvas.height;

    ctx.beginPath();
    ctx.moveTo(radius, 0);
    ctx.lineTo(w - radius, 0);
    ctx.quadraticCurveTo(w, 0, w, radius);
    ctx.lineTo(w, h - radius);
    ctx.quadraticCurveTo(w, h, w - radius, h);
    ctx.lineTo(radius, h);
    ctx.quadraticCurveTo(0, h, 0, h - radius);
    ctx.lineTo(0, radius);
    ctx.quadraticCurveTo(0, 0, radius, 0);
    ctx.closePath();
    ctx.fill();
  }

  drawScratchArea();

  let isDrawing = false;

  canvas.addEventListener('mousedown', () => isDrawing = true);
  canvas.addEventListener('mouseup', () => isDrawing = false);
  canvas.addEventListener('mouseleave', () => isDrawing = false);

  canvas.addEventListener('mousemove', (e) => {
    if (!isDrawing) return;

    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    ctx.globalCompositeOperation = 'destination-out';
    ctx.beginPath();
    ctx.arc(x, y, 20, 0, Math.PI * 2);
    ctx.fill();
    ctx.globalCompositeOperation = 'source-over';
  });
</script>
</body>
</html>
